<div class="mt-10">
  <app-header-title [label]="'Inventory List'" [path]="'inventory'" />
</div>
<div class="flex items-center justify-center">
  <div
    class="bg-white border-4 rounded-lg shadow relative mx-1 md:mx-10 my-10 w-full"
  >
    <div class="p-5 border-b rounded-t">
      <h3 class="text-xl font-semibold">
        @if(productId()) { Edit Product } @else { Add New Product }
      </h3>
      <div class="p-6 space-y-6">
        <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
          <div class="grid grid-cols-6 md:grid-cols-12 gap-6">
            <div class="col-span-6 sm:col-span-3">
              <label
                for="name"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Product Name</label
              >
              <input
                type="text"
                id="name"
                formControlName="name"
                class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5 outline-none"
                placeholder="Enter product name"
              />
              @if(productForm.get('name')?.invalid &&
              productForm.get('name')?.touched) {
              <small class="text-red-500">Product name is required</small>
              }
            </div>

            <div class="col-span-6 sm:col-span-3">
              <label
                for="category"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Category</label
              >
              <input
                type="text"
                id="category"
                formControlName="category"
                class="shadow-sm outline-none bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"
                placeholder="Enter category"
              />
              @if(productForm.get('category')?.invalid &&
              productForm.get('category')?.touched) {
              <small class="text-red-500">Category is required</small>
              }
            </div>

            <div class="col-span-6 sm:col-span-3">
              <label
                for="stock"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Stock</label
              >
              <input
                type="number"
                id="stock"
                formControlName="stock"
                class="shadow-sm outline-none bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"
                placeholder="Enter stock quantity"
              />
              @if(productForm.get('stock')?.invalid &&
              productForm.get('stock')?.touched) {
              <small class="text-red-500"
                >Stock must be a positive number</small
              >
              }
            </div>

            <div class="col-span-6 sm:col-span-3">
              <label
                for="price"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Price</label
              >
              <input
                type="number"
                id="price"
                formControlName="price"
                class="shadow-sm outline-none bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"
                placeholder="Enter price"
              />
              @if(productForm.get('price')?.invalid &&
              productForm.get('price')?.touched) {
              <small class="text-red-500"
                >Price must be a positive number</small
              >
              }
            </div>

            <div class="col-span-6 sm:col-span-3">
              <label
                for="priceAfterDiscount"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Price After Discount</label
              >
              <input
                type="number"
                id="priceAfterDiscount"
                formControlName="priceAfterDiscount"
                class="shadow-sm outline-none bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5"
                placeholder="Enter discounted price"
              />
            </div>
            <div class="col-span-6 sm:col-span-3">
              <div class="card flex flex-col gap-6 items-center justify-center">
                <p-toast />
                <p-fileupload
                  mode="advanced"
                  name="demo[]"
                  chooseIcon="pi pi-upload"
                  url="https://www.primefaces.org/cdn/api/upload.php"
                  accept="image/*"
                  maxFileSize="1000000"
                  (onUpload)="onThumbnailUpload($event)"
                  [auto]="true"
                  chooseLabel="thumbnail"
                />
              </div>
            </div>
            <div class="col-span-6 sm:col-span-3">
              <div class="card flex flex-col gap-6 items-center justify-center">
                <p-toast />
                <p-fileupload
                  mode="advanced"
                  name="demo[]"
                  chooseIcon="pi pi-upload"
                  url="https://www.primefaces.org/cdn/api/upload.php"
                  accept="image/*"
                  maxFileSize="1000000"
                  (onUpload)="onImagesUpload($event)"
                  [auto]="true"
                  [multiple]="true"
                  chooseLabel="images"
                />
              </div>
            </div>
            <div class="col-span-6">
              <label class="text-sm font-medium text-gray-900 block mb-2">
                Product Features
              </label>

              <div formArrayName="features">
                <div
                  *ngFor="let feature of features.controls; let i = index"
                  class="flex gap-2 items-center"
                >
                  <input
                    type="text"
                    [formControlName]="i"
                    class="shadow-sm mb-3 bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-2.5 outline-none"
                    placeholder="Enter feature"
                  />
                  <button
                    type="button"
                    class="text-red-500"
                    (click)="removeFeature(i)"
                  >
                    Remove
                  </button>
                </div>
              </div>

              <button
                type="button"
                class="text-white bg-green-600 hover:bg-green-700 focus:ring-4 focus:ring-green-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center mt-2"
                (click)="addFeature()"
              >
                Add Feature
              </button>
            </div>
            <div class="col-span-full">
              <label
                for="description"
                class="text-sm font-medium text-gray-900 block mb-2"
                >Product Description</label
              >
              <textarea
                id="description"
                formControlName="description"
                rows="6"
                class="bg-gray-50 outline-none border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-cyan-600 focus:border-cyan-600 block w-full p-4"
                placeholder="Enter product description"
              ></textarea>
              @if(productForm.get('description')?.invalid &&
              productForm.get('description')?.touched) {
              <small class="text-red-500">Description is required</small>
              }
            </div>
          </div>

          <div class="mt-6">
            <button
              type="submit"
              [disabled]="productForm.invalid || isUploading"
              class="text-white bg-cyan-600 hover:bg-cyan-700 focus:ring-4 focus:ring-cyan-200 font-medium rounded-lg text-sm px-5 py-2.5 text-center disabled:opacity-50 disabled:cursor-not-allowed"
            >
              @if(isUploading) { Uploading... } @else if(productId()) { Update
              Product } @else { Save Product }
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
